# OCRByMe 快速使用指南

## 🚀 快速开始（推荐）

### 方法一：使用批处理文件（最简单）

1. **将 PDF 文件复制到项目文件夹**
   - 将你要转换的 PDF 文件复制到 `ocrbyme` 文件夹

2. **双击运行批处理文件**
   - 双击 `run_ocr.bat` 文件
   - 等待处理完成

3. **获取结果**
   - ✅ Markdown 文件自动保存到 `out` 文件夹
   - ✅ 内容已复制到剪贴板，直接按 `Ctrl+V` 粘贴即可
   - ✅ 输出文件夹会自动打开

---

## 📝 详细说明

### 批处理文件功能

`run_ocr.bat` 提供以下功能：

- ✅ **自动查找 PDF**：自动识别项目文件夹中的 PDF 文件（排除测试文件）
- ✅ **自动创建输出文件夹**：在 `out` 文件夹中保存结果
- ✅ **自动复制到剪贴板**：处理完成后自动复制内容
- ✅ **自动打开输出文件夹**：方便查看结果
- ✅ **彩色界面**：清晰的进度提示

### 使用限制

- ⚠️ **一次处理一个文件**：如果文件夹中有多个 PDF，只处理第一个
- ⚠️ **排除测试文件**：`test_document.pdf` 和 `enriched_test_document.pdf` 会被跳过

---

## 💡 使用技巧

### 批量处理多个 PDF

如果需要处理多个 PDF 文件，可以：

1. **方法一：逐个处理**
   - 放入一个 PDF，双击 `run_ocr.bat`
   - 处理完成后移走生成的 MD 文件
   - 放入下一个 PDF，再次运行

2. **方法二：使用命令行**
   ```bash
   # 处理单个文件
   ocrbyme document.pdf -o out/document.md

   # 处理多个文件
   for %f in (*.pdf) do ocrbyme "%f" -o "out\%~nf.md"
   ```

3. **方法三：指定页码范围**
   ```bash
   ocrbyme document.pdf --pages 1-10 -o out/document.md
   ```

---

## 📂 文件夹结构

处理后的文件结构：

```
ocrbyme/
├── run_ocr.bat          ← 双击这个文件
├── your_document.pdf    ← 放入你的 PDF 文件
├── out/                 ← 输出文件夹
│   ├── your_document.md
│   ├── another_document.md
│   └── ...
└── venv/                ← 虚拟环境
```

---

## ⚙️ 高级选项

如果需要更多控制，直接使用命令行：

```bash
# 基本用法
ocrbyme input.pdf -o output.md

# 指定页码范围
ocrbyme input.pdf --pages 1-5 -o output.md

# 高分辨率模式（适合复杂布局）
ocrbyme input.pdf --dpi 300 -o output.md

# 只转换前 3 页
ocrbyme input.pdf --first-page 1 --last-page 3 -o output.md

# 显示详细日志
ocrbyme input.pdf --verbose -o output.md
```

---

## 🐛 常见问题

### 1. 批处理文件闪退

**问题**: 双击后窗口立即关闭

**解决方案**:
- 确保已安装虚拟环境：`python -m venv venv`
- 确保已安装依赖：`pip install -e .`

### 2. 未找到 PDF 文件

**问题**: 显示"未找到 PDF 文件"

**解决方案**:
- 将 PDF 文件复制到 `ocrbyme` 文件夹
- 不要放在子文件夹中
- 确保文件扩展名是 `.pdf`

### 3. 剪贴板复制失败

**问题**: 显示"剪贴板复制失败"

**解决方案**:
- 以管理员身份运行批处理文件
- 或手动复制 `out` 文件夹中的 `.md` 文件

### 4. API 认证失败

**问题**: 显示"API 认证失败"

**解决方案**:
- 检查 `.env` 文件中的 `DASHSCOPE_API_KEY`
- 确保已开通阿里云百炼服务

---

## 🎯 完整示例

### 场景：转换一个 PDF 报告

1. **复制 PDF**
   ```
   复制 annual_report.pdf 到 ocrbyme 文件夹
   ```

2. **运行批处理**
   ```
   双击 run_ocr.bat
   ```

3. **等待完成**
   ```
   🚀 开始处理...
   输入文件: annual_report.pdf
   输出文件: out\annual_report.md

   [进度显示...]

   ✅ 转换成功！
   📋 内容已复制到剪贴板！
   ```

4. **使用结果**
   - 打开 Word/记事本/Markdown 编辑器
   - 按 `Ctrl+V` 粘贴
   - 或从 `out` 文件夹打开 `annual_report.md`

---

## 📚 更多帮助

- **完整文档**: 查看 `README.md`
- **快速入门**: 查看 `QUICKSTART.md`
- **项目计划**: 查看 `.claude/plans/` 目录

---

**享受使用 OCRByMe!** 🎉
